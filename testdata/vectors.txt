|===================================|
| FIDO Web Pay (FWP) - Test Vectors |
|===================================|



User FIDO key in JWK format:
{
  "kty": "EC",
  "crv": "P-256",
  "x": "6BKxpty8cI-exDzCkh-goU6dXq3MbcY0cd1LaAxiNrU",
  "y": "mCbcvUzm44j3Lt2b5BPyQloQ91tf2D2V-gzeUxWaUdg",
  "d": "6XxMFXhcYT5QN9w5TIg2aSKsbcj-pj4BnZkK7ZOt4B8"
}


Merchant 'W3C PaymentRequest' (PRCD) data in pretty-printed JSON notation:
{
  "payeeName": "Space Shop",
  "requestId": "7040566321",
  "amount": "435.00",
  "currency": "EUR"
}

Merchant 'hostname' according to the browser: spaceshop.com


Unsigned FWP assertion, here in CBOR 'diagnostic notation':
{
  1: {
    1: "Space Shop",
    2: "7040566321",
    3: "435.00",
    4: "EUR"
  },
  2: "spaceshop.com",
  3: "FR7630002111110020050014382",
  4: "https://banknet2.org",
  5: "0057162932",
  6: "additional stuff...",
  7: {
    1: {
      3: "Android",
      4: "12.0"
    },
    2: {
      3: "Chrome",
      4: "108"
    }
  },
  8: "2023-01-07T10:14:07+01:00",
  -1: {
    1: -7,
    2: {
      1: 2,
      -1: 1,
      -2: h'e812b1a6dcbc708f9ec43cc2921fa0a14e9d5eadcc6dc63471dd4b680c6236b5',
      -3: h'9826dcbd4ce6e388f72edd9be413f2425a10f75b5fd83d95fa0cde53159a51d8'
    }
  }
}

Note that the last element (-1) contains the COSE signature algorithm (ES256) and the FIDO public key (EC/P256) which is also is part of the data to be signed.


The unsigned FWP assertion (binary) converted into a SHA256 hash, here in Base64Url notation:
seF9Q4t3dHXKDzo7QqH1Nf3F1PNAIfq5czTdRpLF3rE
This is subsequently used as FIDO 'challenge'.


****************************************
* FIDO/WebAuthn assertion happens here *
****************************************
Relying party URL: https://mybank.fr

Returned FIDO 'authenticatorData' in hexadecimal notation:
412e175a0f0bdc06dabf0b1db79b97541c08dbacee7e31c97a553588ee922ea70500000017
(here using the UP+UV flags and a zero counter value)

Returned FIDO 'signature' in hexadecimal notation:
3045022100c0784c01d7aea61e158910c3b05ff409105ff0f5f673e19ba3b84756cc2c23f1022035095fd2528c6af9f68a23ec99643359d543faec92c4dfa248e642ca2b5cb8f3

Signed FWP assertion (SAD), here in CBOR 'diagnostic notation':
{
  1: {
    1: "Space Shop",
    2: "7040566321",
    3: "435.00",
    4: "EUR"
  },
  2: "spaceshop.com",
  3: "FR7630002111110020050014382",
  4: "https://banknet2.org",
  5: "0057162932",
  6: "additional stuff...",
  7: {
    1: {
      3: "Android",
      4: "12.0"
    },
    2: {
      3: "Chrome",
      4: "108"
    }
  },
  8: "2023-01-07T10:14:07+01:00",
  -1: {
    1: -7,
    2: {
      1: 2,
      -1: 1,
      -2: h'e812b1a6dcbc708f9ec43cc2921fa0a14e9d5eadcc6dc63471dd4b680c6236b5',
      -3: h'9826dcbd4ce6e388f72edd9be413f2425a10f75b5fd83d95fa0cde53159a51d8'
    },
    3: h'412e175a0f0bdc06dabf0b1db79b97541c08dbacee7e31c97a553588ee922ea70500000017',
    4: h'3045022100c0784c01d7aea61e158910c3b05ff409105ff0f5f673e19ba3b84756cc2c23f1022035095fd2528c6af9f68a23ec99643359d543faec92c4dfa248e642ca2b5cb8f3'
  }
}

The added elements 3,5,4','clientDataJSON' and 'signature' respectively.


The signed FWP assertion as a hex-encoded binary: a901a4016a53706163652053686f70026a3730343035363633323103663433352e30300463455552026d737061636573686f702e636f6d03781b465237363330303032313131313130303230303530303134333832047468747470733a2f2f62616e6b6e6574322e6f7267056a3030353731363239333206736164646974696f6e616c2073747566662e2e2e07a201a20367416e64726f6964046431322e3002a203664368726f6d650463313038087819323032332d30312d30375431303a31343a30372b30313a303020a4012602a401022001215820e812b1a6dcbc708f9ec43cc2921fa0a14e9d5eadcc6dc63471dd4b680c6236b52258209826dcbd4ce6e388f72edd9be413f2425a10f75b5fd83d95fa0cde53159a51d8035825412e175a0f0bdc06dabf0b1db79b97541c08dbacee7e31c97a553588ee922ea705000000170458473045022100c0784c01d7aea61e158910c3b05ff409105ff0f5f673e19ba3b84756cc2c23f1022035095fd2528c6af9f68a23ec99643359d543faec92c4dfa248e642ca2b5cb8f3


*******************************
* FWP encryption happens here *
*******************************

Issuer encryption key in JWK format:
{
  "kty": "OKP",
  "crv": "X25519",
  "x": "6ZoM7yBYlJYNmxwFl4UT3MtCoTv7ztUjpRuKEXrV8Aw",
  "d": "cxfl86EVmcqrR07mWENCf1F_5Ni5mt1ViGyERB6Q1vA"
}


Encrypted FWP assertion (ESAD), here in CBOR 'diagnostic notation:
1010(["https://fido-web-pay.github.io/ns/p1", {
  1: 3,
  2: {
    1: -31,
    3: "x25519:2022:1",
    7: {
      1: 1,
      -1: 4,
      -2: h'91d00183af3e92b443676e3faf8b4b2130bfe6ba98538d27eba49dc1ae386810'
    },
    10: h'06555f65ecf806b6b819216ce9bc51ed1b6800915685a2889f6ef5254d2ca955a49135b25a08c6e9'
  },
  8: h'bbb6e2671e25c6346cebd4877d0b635f',
  9: h'ebe57e33a6bb79e1917dc0be',
  10: h'2c7600f3aa3749829df50347233afb81e4a7674a50470968466050195dabd99f377854885e4838181a844993665726f77a3ff16402e5b45e8479cc8045076483dac05cfcca7a89ae73fe39b0e0ac38e632cb9ee80dc89b5ca5575ddf0c7640c0d674f684f3da4db4ec89dfcdbe345d504f5609f6cfcf27ca112231ee18d8088fe05a9c8d94cf3e7eabe3fcc7f4dd0e81b24a1602731734161c8bae87e147a6e802b694029b92bd3dc07ed34a31753b7c8781e42fa57a43b6c8f10d525007f88d3f88d0e5ca50148d9945fcd355c1029a310cb61fa629c15fa1ea4b3e5b7c69df629ec421167f9ad371fcba77910a4dd4d34081382367751c29ed18781797886e6f91f2377a30bdf6264435781177b28be0c7a53ca97d5d66083fe943bf154b014eb9fd5372fd7be1b11f5142045b6b58566de9975a884f5fa7cdce32ec9293b704d072a17d535dbdc00316d6764b5058b9593cb2bdb2a28f53cee950bb15a400e832977f1315b666ef40664c15401697cf27d4abd4222ecabda6114684e89f1469d79f8571835676df389019'
}])

And as a hex-encoded binary: d903f282782468747470733a2f2f6669646f2d7765622d7061792e6769746875622e696f2f6e732f7031a5010302a401381e036d7832353531393a323032323a3107a30101200421582091d00183af3e92b443676e3faf8b4b2130bfe6ba98538d27eba49dc1ae3868100a582806555f65ecf806b6b819216ce9bc51ed1b6800915685a2889f6ef5254d2ca955a49135b25a08c6e90850bbb6e2671e25c6346cebd4877d0b635f094cebe57e33a6bb79e1917dc0be0a59018c2c7600f3aa3749829df50347233afb81e4a7674a50470968466050195dabd99f377854885e4838181a844993665726f77a3ff16402e5b45e8479cc8045076483dac05cfcca7a89ae73fe39b0e0ac38e632cb9ee80dc89b5ca5575ddf0c7640c0d674f684f3da4db4ec89dfcdbe345d504f5609f6cfcf27ca112231ee18d8088fe05a9c8d94cf3e7eabe3fcc7f4dd0e81b24a1602731734161c8bae87e147a6e802b694029b92bd3dc07ed34a31753b7c8781e42fa57a43b6c8f10d525007f88d3f88d0e5ca50148d9945fcd355c1029a310cb61fa629c15fa1ea4b3e5b7c69df629ec421167f9ad371fcba77910a4dd4d34081382367751c29ed18781797886e6f91f2377a30bdf6264435781177b28be0c7a53ca97d5d66083fe943bf154b014eb9fd5372fd7be1b11f5142045b6b58566de9975a884f5fa7cdce32ec9293b704d072a17d535dbdc00316d6764b5058b9593cb2bdb2a28f53cee950bb15a400e832977f1315b666ef40664c15401697cf27d4abd4222ecabda6114684e89f1469d79f8571835676df389019


FWP assertion delivered by the browser:
{
  "paymentNetworkId": "https://banknet2.org",
  "issuerId": "https://mybank.fr/payment",
  "userAuthorization": "2QPygngkaHR0cHM6Ly9maWRvLXdlYi1wYXkuZ2l0aHViLmlvL25zL3AxpQEDAqQBOB4DbXgyNTUxOToyMDIyOjEHowEBIAQhWCCR0AGDrz6StENnbj-vi0shML_muphTjSfrpJ3BrjhoEApYKAZVX2Xs-Aa2uBkhbOm8Ue0baACRVoWiiJ9u9SVNLKlVpJE1sloIxukIULu24mceJcY0bOvUh30LY18JTOvlfjOmu3nhkX3AvgpZAYwsdgDzqjdJgp31A0cjOvuB5KdnSlBHCWhGYFAZXavZnzd4VIheSDgYGoRJk2ZXJvd6P_FkAuW0XoR5zIBFB2SD2sBc_Mp6ia5z_jmw4Kw45jLLnugNyJtcpVdd3wx2QMDWdPaE89pNtOyJ382-NF1QT1YJ9s_PJ8oRIjHuGNgIj-BanI2Uzz5-q-P8x_TdDoGyShYCcxc0FhyLrofhR6boAraUApuSvT3AftNKMXU7fIeB5C-lekO2yPENUlAH-I0_iNDlylAUjZlF_NNVwQKaMQy2H6YpwV-h6ks-W3xp32KexCEWf5rTcfy6d5EKTdTTQIE4I2d1HCntGHgXl4hub5HyN3owvfYmRDV4EXeyi-DHpTypfV1mCD_pQ78VSwFOuf1Tcv174bEfUUIEW2tYVm3pl1qIT1-nzc4y7JKTtwTQcqF9U129wAMW1nZLUFi5WTyyvbKij1PO6VC7FaQA6DKXfxMVtmbvQGZMFUAWl88n1KvUIi7KvaYRRoTonxRp15-FcYNWdt84kBk"
}
